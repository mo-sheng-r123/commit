"use strict";(self["webpackChunkcommity"]=self["webpackChunkcommity"]||[]).push([[940],{7190:function(t,e,i){i.r(e),i.d(e,{default:function(){return V}});var a=function(){var t=this,e=t._self._c;return e("div",[e("el-row",[e("el-card",{staticClass:"box-card"},[e("el-col",{attrs:{span:24}},[e("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[e("span",[t._v("楼栋管理")]),e("el-form-item",{staticStyle:{width:"30%"}},[e("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:t.form.key,callback:function(e){t.$set(t.form,"key",e)},expression:"form.key"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"}},[t._v("查询")]),e("el-button",{attrs:{type:"success"},on:{click:t.addBulid}},[t._v("添加小区")])],1)],1)],1)],1)],1),e("Terrbuil",{attrs:{dialogVisible:t.dialogVisible,isparent:t.isparent},on:{chansgedialogVisible:t.chansgedialogVisible,chan:t.chan}}),e("Bulltian",{attrs:{dialogVisible:t.dialogVisible,parentdata:t.parentdata,isparent:t.isparent},on:{resetarentdata:t.resetarentdata}})],1)},s=[],l=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:t.title,visible:t.dialogVisible,width:"28%",center:!0,"before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("el-form",{ref:"query",attrs:{model:t.query,"label-width":"80px"}},[e("div",{staticClass:"add"},[e("el-form-item",{attrs:{label:"楼栋pid："}},[e("el-cascader",{attrs:{options:this.$store.state.building.buildingdata,props:{label:"name",value:"id",checkStrictly:!0},clearable:""},model:{value:t.pid,callback:function(e){t.pid=e},expression:"pid"}})],1),e("el-form-item",{attrs:{label:"名称："}},[e("el-input",{attrs:{placeholder:"请输入"},model:{value:t.query.name,callback:function(e){t.$set(t.query,"name",e)},expression:"query.name"}})],1)],1)]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.satlop}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.submit},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit.apply(null,arguments)}}},[t._v("确 定")])],1)],1)},n=[],r={name:"bulltian",props:{dialogVisible:{type:Boolean,default:!1},parentdata:{type:Object,default:()=>{}},isparent:{type:Boolean,default:!0}},data(){return{title:"添加小区",query:{},modcom:{},pid:[]}},created(){this.$bus.$on("xiugai",(t=>{this.modcom=t})),this.$bus.$on("terrData",(t=>{this.trreData=t}))},updated(){this.title=this.modcom.id?"修改小区":"添加小区",this.query=this.modcom?this.modcom:{},this.isparent||(this.pid=this.parentdata.id)},methods:{async submit(){"number"==typeof this.pid?this.query.pid=this.pid:this.query.pid=this.pid.length?this.pid.pop():0;let t=await this.http.post("/building/add",this.query);1e4==t.errCode&&(this.$message.success("添加成功"),this.$bus.$emit("chansgedialogVisible",!1),this.modcom={})},satlop(){this.$bus.$emit("chansgedialogVisible",!1)},handleClose(t){this.$confirm("确认关闭？").then((()=>{this.$bus.$emit("chansgedialogVisible",!1)})).catch((()=>{}))}}},o=r,d=i(1001),c=(0,d.Z)(o,l,n,!1,null,"561a401d",null),h=c.exports,u=function(){var t=this,e=t._self._c;return e("div",[e("el-tree",{attrs:{data:this.$store.state.building.buildingdata?this.$store.state.building.buildingdata:t.terrData,props:t.props,"show-checkbox":!1,"node-key":"id","default-expand-all":!1,"expand-on-click-node":!1},scopedSlots:t._u([{key:"default",fn:function(i){let{node:a,data:s}=i;return e("span",{staticClass:"custom-tree-node"},[e("span",[t._v(t._s(a.label))]),e("span",[e("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(e){return t.sons(s)}}},[t._v(" 添加子类 ")]),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.dom(s)}}},[t._v(" 修改 ")]),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.del(s)}}},[t._v(" 删除 ")])],1)])}}])})],1)},p=[];i(7658);let m=1e3;var b={props:{dialogVisible:{type:Boolean,default:!1},isparent:{type:Boolean,default:!0}},data(){return{terrData:[],props:{label:"name",children:"children"},modcom:{},dia:""}},created(){this.getimte(),this.dia=this.dialogVisible,this.$bus.$on("chansgedialogVisible",(t=>{this.$emit("chan",t),this.getimte()}))},methods:{sons(t){this.$emit("chansgedialogVisible",!0,t,!1)},dom(t){this.modcom=JSON.parse(JSON.stringify(t)),this.$bus.$emit("xiugai",this.modcom),this.$emit("chansgedialogVisible",!0)},del(t){null==t.children?this.$confirm("此操作将永久删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{let e=await this.http.get("/building/delete",{id:t.id});if(1e4==e.errCode){this.$message.success("删除成功");let t=await this.http.get("/building/list");1e4==t.errCode&&(this.terrData=t.data.list,this.$store.commit("setbuilding",t.data.list))}})).catch((()=>{this.$message({type:"info",message:"已取消删除"})})):this.$message.error("暂时不能删除")},async getimte(){if(this.$store.state.building.buildingdata)this.terrData=this.$store.state.building.buildingdata;else{let t=await this.http.get("/building/list");1e4==t.errCode&&(this.terrData=t.data.list,this.$store.commit("setbuilding",t.data.list)),console.log(this.$store.state.building.buildingdata)}},append(t){const e={id:m++,label:"testtest",children:[]};t.children||this.$set(t,"children",[]),t.children.push(e)},remove(t,e){const i=t.parent,a=i.data.children||i.data,s=a.findIndex((t=>t.id===e.id));a.splice(s,1)}}},g=b,f=(0,d.Z)(g,u,p,!1,null,"75045358",null),y=f.exports,$={data(){return{loading:!0,form:{},dialogVisible:!1,isparent:!0,parentdata:{}}},components:{Bulltian:h,Terrbuil:y},created(){this.getimte()},methods:{resetarentdata(){this.parentdata={}},chansgedialogVisible(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.dialogVisible=t,e&&(this.parentdata=e),this.isparent=i},chan(t){this.dialogVisible=t,this.getimte()},async getimte(){let t=await this.http.get("/building/list");1e4==t.errCode&&(this.terrData=t.data.list,this.$store.commit("setbuilding",t.data.list))},addBulid(){this.dialogVisible=!0},handleClose(t){this.$confirm("确认关闭？").then((()=>{t()})).catch((()=>{}))}}},v=$,k=(0,d.Z)(v,a,s,!1,null,"02cc4eaf",null),V=k.exports}}]);
//# sourceMappingURL=940.707a1b3e.js.map