"use strict";(self["webpackChunkcommity"]=self["webpackChunkcommity"]||[]).push([[944],{2767:function(e,t,a){a.d(t,{Z:function(){return c}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"block"},[t("el-pagination",{attrs:{"current-page":this.query.page,"page-sizes":[5,10,15,20],"page-size":this.query.psize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},l=[],i={name:"Paging",props:{query:{type:Object,require:()=>{}},total:{type:Number,require:()=>{}}},data(){return{}},methods:{handleSizeChange(e){this.query.psize=e,this.loading=!1,this.$emit("paging")},handleCurrentChange(e){this.query.page=e,this.$emit("paging"),this.loading=!1}}},r=i,o=a(1001),n=(0,o.Z)(r,s,l,!1,null,"37f50908",null),c=n.exports},466:function(e,t,a){a.d(t,{Z:function(){return c}});var s=function(){var e=this,t=e._self._c;return t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"element-loading-background":"rgba(0, 0, 0, 0)"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),e._l(e.tableCouml,(function(a,s){return[a.isshow?t("el-table-column",{key:s,attrs:{label:a.label},scopedSlots:e._u([{key:"default",fn:function(t){return[e._t(a.showname,null,{data:t.row})]}}],null,!0)}):t("el-table-column",{key:s,attrs:{prop:a.prop,label:a.label,width:a.width}})]}))],2)},l=[],i={name:"tablecom",props:{loading:{type:Boolean,default:()=>!0},tableData:{type:Array,default:()=>[]},tableCouml:{type:Array,default:()=>[]}},data(){return{}},created(){},methods:{handleSelectionChange(e){e.forEach((e=>{this.$emit("idshow",e.id)}))}}},r=i,o=a(1001),n=(0,o.Z)(r,s,l,!1,null,"8f316a3a",null),c=n.exports},8944:function(e,t,a){a.r(t),a.d(t,{default:function(){return b}});var s=function(){var e=this,t=e._self._c;return t("div",[t("el-card",{staticClass:"box-card"},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("门店管理")])])]),t("el-row",[t("el-form",{ref:"form",attrs:{model:e.query,"label-width":"80px"}},[t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:"门店"}},[t("el-input",{attrs:{placeholder:"门店名"},on:{change:e.inquire},model:{value:e.query.key,callback:function(t){e.$set(e.query,"key",t)},expression:"query.key"}})],1),t("el-form-item",{attrs:{label:"服务范围"}},[t("el-select",{attrs:{placeholder:"请选择"},on:{change:e.inquire},model:{value:e.query.services,callback:function(t){e.$set(e.query,"services",t)},expression:"query.services"}},e._l(e.storeserviceslist,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.inquire}},[e._v("查询")])],1)],1)],1)],1),t("el-row",[t("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("添加")]),t("el-button",{attrs:{type:"danger"}},[e._v("批量删除")])],1),t("Table",{attrs:{loading:e.loading,tableData:e.tableData,tableCouml:e.tableCouml},on:{idshow:e.idshow},scopedSlots:e._u([{key:"logo",fn:function(a){return[a.data.logo?t("el-image",{staticStyle:{width:"40px",height:"40px"},attrs:{src:e.url+a.data.logo,fit:"fill"}}):t("el-image",{staticStyle:{width:"40px",height:"40px"},attrs:{src:"https://img1.baidu.com/it/u=413643897,2296924942&fm=253&fmt=auto&app=138&f=JPEG?w=800&h=500",fit:"fill"}})]}},{key:"services",fn:function(a){return["3"===a.data.services?t("p",[e._v("服装鞋帽")]):e._e(),"2"===a.data.services?t("p",[e._v("蔬菜水果")]):e._e(),"1"===a.data.services?t("p",[e._v("早餐早点")]):e._e(),""===a.data.services?t("p",[e._v(e._s(a.data.services))]):e._e()]}},{key:"option",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(t){return e.mod(a.data)}}},[e._v("修改")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(a.data.id)}}},[e._v("删除")])]}}])}),t("Paging",{attrs:{query:e.query,total:e.total},on:{paging:e.paging}}),t("StoreAdd",{attrs:{dialogVisible:e.dialogVisible,tite:e.tite,form:e.form},on:{change:e.change}})],1)},l=[],i=a(466),r=a(2767),o=function(){var e=this,t=e._self._c;return t("div",[t("el-dialog",{attrs:{title:e.tite,center:"",visible:e.dialogVisible,width:"60%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{staticClass:"box"},[t("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px"}},[t("div",{staticClass:"box-left"},[t("el-form-item",{attrs:{label:"店名："}},[t("el-input",{staticStyle:{width:"80%"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"手机号："}},[t("el-input",{staticStyle:{width:"80%"},attrs:{maxlength:"11"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),t("el-form-item",{attrs:{label:"营业时间："}},[t("el-time-select",{staticStyle:{width:"30%"},attrs:{placeholder:"起始","picker-options":{start:"08:30",step:"00:15",end:"18:30"}},model:{value:e.form.startTime,callback:function(t){e.$set(e.form,"startTime",t)},expression:"form.startTime"}}),t("el-time-select",{staticStyle:{width:"30%"},attrs:{placeholder:"结束","picker-options":{start:"08:30",step:"00:15",end:"18:30",minTime:e.startTime}},model:{value:e.form.endTime,callback:function(t){e.$set(e.form,"endTime",t)},expression:"form.endTime"}})],1),t("el-form-item",{attrs:{label:"服务范围"}},[t("el-select",{attrs:{placeholder:"请选择活动区域"},model:{value:e.form.services,callback:function(t){e.$set(e.form,"services",t)},expression:"form.services"}},e._l(e.storeserviceslist,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"店主："}},[t("el-input",{staticStyle:{width:"80%"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),t("el-form-item",{attrs:{label:"门店介绍："}},[t("el-input",{staticStyle:{width:"80%"},attrs:{type:"textarea",rows:"5"},model:{value:e.form.intro,callback:function(t){e.$set(e.form,"intro",t)},expression:"form.intro"}})],1)],1),t("div",{staticClass:"box-right"},[t("el-form-item",{attrs:{label:"门店地址："}},[t("el-input",{staticStyle:{width:"80%"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),t("el-form-item",{attrs:{label:"门店logo："}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://estate.eshareedu.cn/estate/api/upload/add","show-file-list":!1,headers:e.token,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.imageUrl?t("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t("el-form-item",{attrs:{label:"门店图片："}},[t("el-upload",{staticClass:"upload-demo",attrs:{action:"http://www.eshareedu.cn/estate/api/upload/editeradd","on-success":e.hangesuccess,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"file-list":e.fileList,headers:e.token,multiple:"","list-type":"picture"}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])],1)],1)],1)])],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.funselect}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)])],1)},n=[],c=(a(7658),{props:{dialogVisible:{typeof:Boolean,Reflect:()=>falses},tite:{typeof:Number,Reflect:"添加门店"},form:{typeof:Object,Reflect:()=>{}}},data(){return{url:"http://estate.eshareedu.cn/estate/upload/",startTime:"",endTime:"",storeserviceslist:"",fileList:[],token:{Authorization:""},imageUrl:""}},created(){this.getstoreservices(),this.token.Authorization=sessionStorage.getItem("token")},methods:{async submit(){let e=await this.http.post("/stores/add",this.form);1e4===e.errCode?(this.$message({message:"添加成功",type:"success"}),this.$emit("change",!1)):this.$message({message:"添加失败",type:"error"})},async getstoreservices(){let e=await this.http.get("/storeservices/list");1e4===e.errCode&&(this.storeserviceslist=e.data.list)},handleAvatarSuccess(e,t){this.imageUrl=URL.createObjectURL(t.raw),this.form.logo=e.data},beforeAvatarUpload(e){const t="image/jpeg"===e.type,a=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&a},handleRemove(e,t){},handlePreview(e){},hangesuccess(e,t){this.images.push({url:t.name})},funselect(){this.$emit("change",!1)},handleClose(e){this.$confirm("确认关闭？").then((()=>{this.$emit("change",!1)})).catch((()=>{}))}},watch:{form:{handler(e){console.log(e),this.$nextTick((()=>{e.id&&(this.imageUrl=this.url+e.logo,console.log(this.imageUrl))}))},deep:!0}}}),d=c,u=a(1001),m=(0,u.Z)(d,o,n,!1,null,"b0c7c7f2",null),p=m.exports,h={data(){return{query:{page:1,psize:5},dialogVisible:!1,storeserviceslist:[],loading:!0,tableData:[],tableCouml:[{prop:"id",label:"ID"},{prop:"name",label:"门店"},{prop:"address",label:"地址"},{prop:"logo",label:"门店logo",isshow:!0,showname:"logo"},{prop:"services",label:"服务范围",isshow:!0,showname:"services"},{prop:"username",label:"店主"},{prop:"mobile",label:"联系电话"},{prop:"startTime",label:"营业时间"},{label:"操作",isshow:!0,showname:"option"}],total:0,url:"http://estate.eshareedu.cn/estate/upload/",tite:"添加门店",form:{}}},components:{Table:i.Z,Paging:r.Z,StoreAdd:p},created(){this.getstoreservices(),this.getstorelist()},methods:{async handleDelete(e){let t={id:e},a=await this.http.get("/stores/delete",t);console.log(a),1e4===a.errCode&&(this.$message({message:"删除成功",type:"success"}),this.getstorelist())},add(){this.dialogVisible=!0,this.form={id:0},this.tite="添加门店"},change(e){this.dialogVisible=e,this.getstoreservices()},inquire(){this.getstorelist()},paging(){this.getstorelist()},idshow(e){console.log(e)},mod(e){this.dialogVisible=!0,this.form=e,this.tite="修改门店"},async getstoreservices(){let e=await this.http.get("/storeservices/list");1e4===e.errCode&&(this.storeserviceslist=e.data.list)},async getstorelist(){let e=await this.http.get("/stores/list",this.query);console.log(e),1e4===e.errCode&&(this.tableData=e.data.list,this.total=e.data.counts,this.loading=!1)}}},f=h,g=(0,u.Z)(f,s,l,!1,null,"ffaf394c",null),b=g.exports}}]);
//# sourceMappingURL=944.0e1bfaf1.js.map